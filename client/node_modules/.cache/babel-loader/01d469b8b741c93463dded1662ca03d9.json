{"ast":null,"code":"import FormData from 'form-data'; //class que permite enviar imagens para o backend\n\nimport BuscaBD from \"../../../fetchBackEnd/api\"; //classe axios\n\nasync function CriaAnuncio(event, formulario, formularioOpcionais) {\n  //fazupload imagens e retornar o nome e caminho de cada imagem no node\n  event.preventDefault();\n  const classBuscaBD = new BuscaBD(); // classe da Api onde está conf  o Axios\n\n  const dadosImagens = new FormData(); //FormData classe que permite o multer identificar as imagens\n\n  for (var i = 0; i < formulario.imagensPath.length; i++) {\n    dadosImagens.append(\"files\", formulario.imagensPath[i]);\n  } //para enviar imagens tem q ser pelo FormData\n  //primeiro coloca eles numa array com o loop for. Necessário quando é mais de uma imagem\n\n\n  const retornaImagenslLocationNodeMulter = await classBuscaBD.CadastraImagemMulter(dadosImagens); //faz o upload das imagens e o node vai retornar as imagens recebidas\n\n  if (retornaImagenslLocationNodeMulter.data.token === \"expired\") {\n    alert(\"SESSÃO EXPIRADA. NECESSÁRIO LOGAR NOVAMENTE\");\n    window.location.href = \"http://192.168.0.150:3000/login\";\n    return;\n  }\n\n  console.log(retornaImagenslLocationNodeMulter);\n  let imagensPath = []; //faz um map na array nos nomes das imagens retornadas do Node\n\n  retornaImagenslLocationNodeMulter.data.map(dados => {\n    imagensPath.push(dados.filename); //armezeneo nome das imagens em array\n  });\n  const GuardaDados = await ArmazenaDadosBD(imagensPath, formulario, formularioOpcionais); //chama a func armazena dados enviado o nome das imagens recebidas em array\n\n  console.log(GuardaDados);\n  window.location.href = \"#inicio\";\n  return GuardaDados; // props.mensagemDeRetorno(GuardaDados.data)\n  //retorna mensagem de sucesso ou não\n} //com os nomes das imagens no node, reuni todos os dados do carro e junta com o nome das imagens\n\n\n_c = CriaAnuncio;\n\nasync function ArmazenaDadosBD(recebeLocationImagens, formulario, formularioOpcionais) {\n  const classBuscaBD = new BuscaBD();\n  var imagensLocation = JSON.stringify(recebeLocationImagens); //transforma a array de localização das imagens em uma array String, para poder ser gravado em um único campo no BD\n\n  var reuniDados = formulario;\n  reuniDados = { ...reuniDados,\n    valor: reuniDados.valor.slice(3, -3)\n  }; //3 RETIRA R$  do incio e o -3 retira ,00 do final da string\n\n  reuniDados = { ...reuniDados,\n    imagensPath: imagensLocation\n  }; //add os nomes da imagem no obj reunidados, que é o formulario\n\n  var reunidadosFinal = Object.assign(reuniDados, formularioOpcionais); // Object.assign torna dois objs em um só\n\n  console.log(reuniDados);\n  const EnviaDadosBD = await classBuscaBD.CadastraDadosBD(reunidadosFinal);\n\n  if (EnviaDadosBD.data.token === \"expired\") {\n    alert(\"SESSÃO EXPIRADA. NECESSÁRIO LOGAR NOVAMENTE\");\n    window.location.href = \"http://192.168.0.150:3000/login\";\n    return;\n  }\n\n  return EnviaDadosBD;\n}\n\n_c2 = ArmazenaDadosBD;\nexport default CriaAnuncio;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CriaAnuncio\");\n$RefreshReg$(_c2, \"ArmazenaDadosBD\");","map":{"version":3,"sources":["/home/marco/Documents/project_react/template-carros/client/src/components/painelAdministrativo/formulario/functions/funtionCriarAnuncio.js"],"names":["FormData","BuscaBD","CriaAnuncio","event","formulario","formularioOpcionais","preventDefault","classBuscaBD","dadosImagens","i","imagensPath","length","append","retornaImagenslLocationNodeMulter","CadastraImagemMulter","data","token","alert","window","location","href","console","log","map","dados","push","filename","GuardaDados","ArmazenaDadosBD","recebeLocationImagens","imagensLocation","JSON","stringify","reuniDados","valor","slice","reunidadosFinal","Object","assign","EnviaDadosBD","CadastraDadosBD"],"mappings":"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","sourcesContent":["import FormData from 'form-data' //class que permite enviar imagens para o backend\nimport BuscaBD from \"../../../fetchBackEnd/api\" //classe axios\n\nasync function CriaAnuncio(event, formulario, formularioOpcionais) {//fazupload imagens e retornar o nome e caminho de cada imagem no node\n    event.preventDefault()\n    const classBuscaBD = new BuscaBD()// classe da Api onde está conf  o Axios\n    const dadosImagens = new FormData()//FormData classe que permite o multer identificar as imagens\n    for (var i = 0; i < formulario.imagensPath.length; i++) {\n        dadosImagens.append(\"files\", formulario.imagensPath[i])\n    }\n    //para enviar imagens tem q ser pelo FormData\n    //primeiro coloca eles numa array com o loop for. Necessário quando é mais de uma imagem\n\n    const retornaImagenslLocationNodeMulter = await classBuscaBD.CadastraImagemMulter(dadosImagens)\n    //faz o upload das imagens e o node vai retornar as imagens recebidas\n\n    if (retornaImagenslLocationNodeMulter.data.token === \"expired\") {\n        alert(\"SESSÃO EXPIRADA. NECESSÁRIO LOGAR NOVAMENTE\")\n        window.location.href = (\"http://192.168.0.150:3000/login\")\n        return\n    }\n    console.log(retornaImagenslLocationNodeMulter)\n    let imagensPath = []\n    //faz um map na array nos nomes das imagens retornadas do Node\n    retornaImagenslLocationNodeMulter.data.map((dados) => {\n        imagensPath.push(dados.filename)//armezeneo nome das imagens em array\n    })\n    const GuardaDados = await ArmazenaDadosBD(imagensPath, formulario, formularioOpcionais) //chama a func armazena dados enviado o nome das imagens recebidas em array\n    console.log(GuardaDados)\n    window.location.href = (\"#inicio\")\n    return GuardaDados\n    // props.mensagemDeRetorno(GuardaDados.data)\n    //retorna mensagem de sucesso ou não\n\n}\n\n//com os nomes das imagens no node, reuni todos os dados do carro e junta com o nome das imagens\nasync function ArmazenaDadosBD(recebeLocationImagens, formulario, formularioOpcionais) {\n    const classBuscaBD = new BuscaBD()\n    var imagensLocation = JSON.stringify(recebeLocationImagens);//transforma a array de localização das imagens em uma array String, para poder ser gravado em um único campo no BD\n    var reuniDados = formulario\n    reuniDados = { ...reuniDados, valor: reuniDados.valor.slice(3, -3) } //3 RETIRA R$  do incio e o -3 retira ,00 do final da string\n    reuniDados = { ...reuniDados, imagensPath: imagensLocation } //add os nomes da imagem no obj reunidados, que é o formulario\n    var reunidadosFinal = Object.assign(reuniDados, formularioOpcionais) // Object.assign torna dois objs em um só\n    console.log(reuniDados)\n    const EnviaDadosBD = await classBuscaBD.CadastraDadosBD(reunidadosFinal)\n    if (EnviaDadosBD.data.token === \"expired\") {\n        alert(\"SESSÃO EXPIRADA. NECESSÁRIO LOGAR NOVAMENTE\")\n        window.location.href = (\"http://192.168.0.150:3000/login\")\n        return\n    }\n\n    return EnviaDadosBD\n}\n\nexport default CriaAnuncio"]},"metadata":{},"sourceType":"module"}